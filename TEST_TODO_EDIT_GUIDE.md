# 测试待办编辑功能指南

## 🚀 快速测试

### 方法 1: 使用测试应用（推荐）

1. **运行测试应用**:
```bash
flutter run test_todo_edit_dialog.dart
```

2. **点击按钮**: 点击屏幕中央的"打开编辑对话框"按钮

3. **验证对话框**: 应该看到一个白色的对话框，包含：
   - 标题："编辑待办事项"
   - 标题输入框（已填充"测试待办"）
   - 描述输入框（已填充"这是一个测试待办事项"）
   - 分类下拉框（显示"工作"）
   - 优先级下拉框（显示"中"）
   - 截止日期选择器
   - 删除、取消、保存按钮

### 方法 2: 在实际应用中测试

1. **运行主应用**:
```bash
flutter run lib/main.dart
```

2. **创建待办**:
   - 点击麦克风按钮
   - 说话或输入文字
   - 创建一个待办事项

3. **点击待办**:
   - 在待办列表中找到刚创建的待办
   - 点击待办的**文字区域**（不是复选框）
   - 应该弹出编辑对话框

4. **测试编辑**:
   - 修改标题
   - 修改描述
   - 更改分类
   - 更改优先级
   - 设置截止日期
   - 点击"保存"

5. **验证更新**:
   - 对话框关闭
   - 待办列表中的待办已更新
   - 显示成功提示

## 🎯 测试清单

### 基本功能
- [ ] 点击待办文字区域能打开对话框
- [ ] 对话框有明显的背景色（白色或主题色）
- [ ] 对话框显示在屏幕中央
- [ ] 对话框有圆角和阴影

### 表单字段
- [ ] 标题输入框显示当前标题
- [ ] 描述输入框显示当前描述
- [ ] 分类下拉框显示当前分类
- [ ] 优先级下拉框显示当前优先级
- [ ] 截止日期显示当前日期（如果有）

### 编辑功能
- [ ] 可以修改标题
- [ ] 可以修改描述
- [ ] 可以更改分类
- [ ] 可以更改优先级
- [ ] 可以设置/修改截止日期
- [ ] 可以清除截止日期

### 验证功能
- [ ] 清空标题后点击保存，显示错误提示
- [ ] 设置过去的日期，显示错误提示
- [ ] 输入时错误提示自动消失

### 按钮功能
- [ ] 点击"取消"关闭对话框，不保存修改
- [ ] 点击"保存"更新待办并关闭对话框
- [ ] 点击"删除"显示确认对话框
- [ ] 确认删除后待办被删除

### 交互细节
- [ ] 点击复选框只切换完成状态，不打开对话框
- [ ] 对话框打开时标题输入框自动聚焦
- [ ] 字符计数正确显示
- [ ] 优先级选择器显示颜色圆点

## 🐛 常见问题

### 问题 1: 点击后只有遮罩，没有对话框

**原因**: Dialog 背景色缺失或透明

**解决**: 已在代码中添加明确的背景色
```dart
Dialog(
  backgroundColor: theme.colorScheme.surface,
  ...
)
```

### 问题 2: 点击复选框也打开对话框

**原因**: 点击事件冲突

**解决**: 已将点击处理移到内容区域，复选框独立处理

### 问题 3: 对话框显示但无法交互

**原因**: 可能是 Provider 未正确配置

**检查**: 确保 TodoProvider 已在 MaterialApp 上层配置

### 问题 4: 保存后没有更新

**原因**: `updateTodoWithValidation()` 方法可能有问题

**检查**: 查看控制台是否有错误信息

## 📱 测试截图说明

### 1. 待办列表
```
┌─────────────────────────────┐
│  待办列表                    │
├─────────────────────────────┤
│  ☐ 买大白菜和土豆            │  ← 点击这里
│     购物 | 中                │
├─────────────────────────────┤
│  ☐ 完成项目报告              │
│     工作 | 高                │
└─────────────────────────────┘
```

### 2. 编辑对话框
```
┌─────────────────────────────────┐
│  编辑待办事项                    │
│                                 │
│  标题 *                         │
│  ┌─────────────────────────┐   │
│  │ 买大白菜和土豆           │   │
│  └─────────────────────────┘   │
│                                 │
│  描述                           │
│  ┌─────────────────────────┐   │
│  │                         │   │
│  └─────────────────────────┘   │
│                                 │
│  分类: [购物 ▼]                 │
│  优先级: [● 中 ▼]               │
│  截止日期: [选择日期]            │
│                                 │
│  [删除]  [取消]  [保存]         │
└─────────────────────────────┘
```

## 🎬 测试视频脚本

1. **打开应用** (0:00-0:05)
   - 显示待办列表

2. **点击待办** (0:05-0:10)
   - 点击待办文字区域
   - 对话框从中央弹出

3. **查看表单** (0:10-0:20)
   - 展示所有表单字段
   - 显示当前值

4. **编辑内容** (0:20-0:40)
   - 修改标题
   - 修改描述
   - 更改分类
   - 更改优先级
   - 设置截止日期

5. **保存更新** (0:40-0:50)
   - 点击保存按钮
   - 对话框关闭
   - 列表更新

6. **测试验证** (0:50-1:00)
   - 清空标题
   - 点击保存
   - 显示错误提示

7. **测试删除** (1:00-1:10)
   - 点击删除按钮
   - 显示确认对话框
   - 确认删除

## 📊 性能测试

### 对话框打开速度
- **目标**: < 100ms
- **测试**: 点击待办后立即显示对话框

### 保存响应速度
- **目标**: < 200ms
- **测试**: 点击保存后立即更新列表

### 动画流畅度
- **目标**: 60 FPS
- **测试**: 对话框打开/关闭动画流畅

## ✅ 测试通过标准

- ✅ 所有基本功能正常
- ✅ 所有表单字段正常
- ✅ 所有编辑功能正常
- ✅ 所有验证功能正常
- ✅ 所有按钮功能正常
- ✅ 所有交互细节正常
- ✅ 无控制台错误
- ✅ 性能达标

## 🎉 测试完成

如果所有测试项都通过，说明待办编辑功能已完全正常！

---

**测试指南版本**: 1.0  
**最后更新**: 2026-01-29  
**适用版本**: voice_todo v1.0.0+1
